from typing import List, Dict, Any
from prettytable import PrettyTable, DEFAULT
import math


def format_genres_table(genres: List[str], columns: int = 4) -> None:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤ –≤ –≤–∏–¥–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–ª–æ–Ω–æ–∫.

    –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
    -----------
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ui_controller.handle_genre_year_search()` –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
    –∂–∞–Ω—Ä–æ–≤ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –≤—ã–±–æ—Ä. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
    –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ.

    –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
    ----------
    genres : List[str]
        –°–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –≠–ª–µ–º–µ–Ω—Ç—ã ‚Äî —Å—Ç—Ä–æ–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: ["Action", "Drama", "Comedy"].
        –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –∏–∑ `mysql_connector.get_genres_with_ids()` ‚Üí –∑–∞—Ç–µ–º –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏—è.

    columns : int, optional
        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 4. –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —à–∏—Ä–∏–Ω—É —Ç–∞–±–ª–∏—Ü—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        –æ—Ç –¥–ª–∏–Ω—ã —Å–ø–∏—Å–∫–∞ –∂–∞–Ω—Ä–æ–≤ –∏ —à–∏—Ä–∏–Ω—ã —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.

    –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
    ----------
    - –ï—Å–ª–∏ `genres` ‚Äî –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤", –∏ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.
    - –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫: `rows = ceil(len(genres) / columns)`.
        ‚Üí –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∂–∞–Ω—Ä—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º.
    - –°–æ–∑–¥–∞—ë—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ (`matrix`) —Ä–∞–∑–º–µ—Ä–∞ [rows x columns], –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏.
    - –ñ–∞–Ω—Ä—ã –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º:
        * `row = idx % rows`
        * `col = idx // rows`
        –¢–∞–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑, –∑–∞—Ç–µ–º –≤–ø—Ä–∞–≤–æ.
    - –î–∞–ª–µ–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ `col_widths`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–∏ ‚Äî
      –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è.
    - –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `.ljust(col_widths[i])` ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç
      —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ—Ç—Å—Ç—É–ø –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫.

    –í—ã–≤–æ–¥:
    ------
    None
        –§—É–Ω–∫—Ü–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç. –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª —á–µ—Ä–µ–∑ `print()`.

    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
    -----------
    –ù–µ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—É—Å—Ç–æ–π –≤–≤–æ–¥ –∂–∞–Ω—Ä–æ–≤.
    –í—Å–µ —Ä–∞—Å—á—ë—Ç—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–µ ‚Äî –æ—à–∏–±–æ–∫ —Ç–∏–ø–∞ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å –Ω–µ—Ç.

    –ì–∞—Ä–∞–Ω—Ç–∏–∏:
    ---------
    - –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–æ–≤–Ω–æ `columns` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫ —Å–ø—Ä–∞–≤–∞).
    - –í—Å–µ –∂–∞–Ω—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π (`"1. Action"`, `"2. Drama"` –∏ —Ç.–¥.).
    - –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —à–∏—Ä–∏–Ω–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —Ä–∞–∑–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –∂–∞–Ω—Ä–æ–≤.
    """
    if not genres:
        print("ü§∑ –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤.")
        return

    print("\nüìö –î–æ—Å—Ç—É–ø–Ω—ã–µ –∂–∞–Ω—Ä—ã:")

    rows = math.ceil(len(genres) / columns)
    matrix = [["" for _ in range(columns)] for _ in range(rows)]

    for idx, genre in enumerate(genres):
        row = idx % rows
        col = idx // rows
        matrix[row][col] = f"{idx + 1}. {genre}"

    col_widths = [max(len(matrix[row][col]) for row in range(rows)) for col in range(columns)]

    for row in matrix:
        line = "   ".join(cell.ljust(col_widths[i]) for i, cell in enumerate(row))
        print(line)


def format_movies_table(movies: List[Dict[str, Any]], page: int = 1, per_page: int = 10) -> None:
    """
       –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∏–ª—å–º–∞—Ö –≤ –∫–æ–Ω—Å–æ–ª—å, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥—É–ª—å PrettyTable.
       –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∏—Å–∫–∞.

       –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
       -----------
       –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ui_controller.handle_keyword_search()` –∏ `handle_genre_year_search()` ‚Äî
       –ø—Ä–∏ –≤—ã–≤–æ–¥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∏—Å–∫–∞ –ø–æ —Ñ–∏–ª—å–º–∞–º (–ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É, –∂–∞–Ω—Ä—É –∏ –≥–æ–¥—É).
       –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–∏–ª—å–º—ã –≤ –≤–∏–¥–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: –Ω–æ–º–µ—Ä, –Ω–∞–∑–≤–∞–Ω–∏–µ, –≥–æ–¥, –∂–∞–Ω—Ä—ã, —Ä–µ–π—Ç–∏–Ω–≥, –∞–∫—Ç—ë—Ä—ã.

       –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
       ----------
       movies : List[Dict[str, Any]]
           –°–ø–∏—Å–æ–∫ —Ñ–∏–ª—å–º–æ–≤, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–∞–º–∏:
               - "title" : str ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞
               - "release_year" : int ‚Äî –≥–æ–¥ –≤—ã—Ö–æ–¥–∞
               - "genre" : str ‚Äî —Å—Ç—Ä–æ–∫–∞ –∂–∞–Ω—Ä–æ–≤ (—Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø—è—Ç–æ–π)
               - "rating" : str ‚Äî –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "PG-13")
               - "actors" : Union[str, List[str]] ‚Äî —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω –∞–∫—Ç—ë—Ä–æ–≤

       page : int, optional
           –ù–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —Ñ–∏–ª—å–º–æ–≤.

       per_page : int, optional
           –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å–º–æ–≤, –≤—ã–≤–æ–¥–∏–º—ã—Ö –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî 10.

       –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
       ----------
       1. –ï—Å–ª–∏ `movies` –ø—É—Å—Ç ‚Äî –ø–µ—á–∞—Ç–∞–µ—Ç "–§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã" –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
       2. –†–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –∏–Ω–¥–µ–∫—Å–æ–≤:
           * `start = (page - 1) * per_page`
           * `end = start + per_page`
           ‚Üí –°—Ä–µ–∑ `movies[start:end]` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
       3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç `PrettyTable`:
           - –ó–∞–¥–∞—ë—Ç —Å—Ç–∏–ª—å: `DEFAULT`
           - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫: `["‚Ññ", "–ù–∞–∑–≤–∞–Ω–∏–µ", "–ì–æ–¥", "–ñ–∞–Ω—Ä", "–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è", "–ê–∫—Ç—ë—Ä—ã"]`
           - –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤—Å–µ –ø–æ–ª—è –ø–æ —Ü–µ–Ω—Ç—Ä—É
           - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫: `–ù–∞–∑–≤–∞–Ω–∏–µ` ‚Äî 30, `–ê–∫—Ç—ë—Ä—ã` ‚Äî 60
       4. –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç —Ñ–∏–ª—å–º—ã –≤ —Ç–µ–∫—É—â–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ:
           - –ò–Ω–¥–µ–∫—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `start + 1` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –Ω—É–º–µ—Ä–æ–≤–∞–Ω–∏—è
           - –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è (`.get`) —Å –ø–æ–¥—Å—Ç—Ä–∞—Ö–æ–≤–∫–æ–π –Ω–∞ `None`
           - –ê–∫—Ç—ë—Ä—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è:
               * –ï—Å–ª–∏ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ ‚Üí `.join(...)`
               * –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ ‚Üí –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
           - –î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É

       5. –ü–µ—á–∞—Ç–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —á–µ—Ä–µ–∑ `print(table)`.

       –í—ã–≤–æ–¥:
       ------
       None
           –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏. –í–æ–∑–≤—Ä–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

       –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
       -----------
       - –ù–µ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
       - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `.get()`, –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è placeholder-–∑–Ω–∞—á–µ–Ω–∏—è ("‚ùì", "‚Äî").

       –ì–∞—Ä–∞–Ω—Ç–∏–∏:
       ---------
       - –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ–¥–∏–Ω —Ñ–∏–ª—å–º, –≤–∫–ª—é—á–∞—è –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è.
       - –í—ã–≤–æ–¥ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —à–∏—Ä–∏–Ω—ã —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ ‚Äî –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–∂–∞—é—Ç—Å—è.
       - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ, —Ç–∞–∫ –∏ —Å–ø–∏—Å–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç—ë—Ä–æ–≤.
       """

    if not movies:
        print("üò¢ –§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.")
        return

    total = len(movies)
    start = (page - 1) * per_page
    end = start + per_page
    page_movies = movies[start:end]

    table = PrettyTable()
    table.set_style(DEFAULT)
    table.field_names = ["‚Ññ", "–ù–∞–∑–≤–∞–Ω–∏–µ", "–ì–æ–¥", "–ñ–∞–Ω—Ä", "–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è", "–ê–∫—Ç—ë—Ä—ã"]
    table.align["–ù–∞–∑–≤–∞–Ω–∏–µ"] = "c"
    table.align["–ì–æ–¥"] = "c"
    table.align["–ñ–∞–Ω—Ä"] = "c"
    table.align["–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è"] = "c"
    table.align["–ê–∫—Ç—ë—Ä—ã"] = "c"
    table.max_width["–ù–∞–∑–≤–∞–Ω–∏–µ"] = 30
    table.max_width["–ê–∫—Ç—ë—Ä—ã"] = 60

    for idx, film in enumerate(page_movies, start=start + 1):
        title = film.get("title") or "‚ùì"
        year = str(film.get("release_year") or "‚Äî")
        genre = film.get("genre") or "‚Äî"
        rating = film.get("rating") or "‚Äî"
        actors = film.get("actors") or []
        actors_str = ", ".join(actors) if isinstance(actors, list) else str(actors)

        table.add_row([idx, title, year, genre, rating, actors_str])

    print(table)


def format_top_keywords(keywords: List[Dict[str, Any]]) -> None:
    """
        –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–∞–º—ã—Ö —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

        –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
        -----------
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ui_controller.handle_statistics()` –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø–æ–∏—Å–∫–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.
        –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äî `log_stats.get_top_keywords()` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤.

        –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
        ----------
        keywords : List[Dict[str, Any]]
            –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è:
                - "_id"   : str  ‚Äî –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ, –∫–∞–∫ –µ–≥–æ –≤–≤–æ–¥–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∫–æ–º–µ–¥–∏—è", "–¢–∞—Ä–∞–Ω—Ç–∏–Ω–æ")
                - "count" : int  ‚Äî –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —ç—Ç–∏–º —Å–ª–æ–≤–æ–º

            –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ª–æ–≥–æ–≤ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É, –Ω–∞–ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ MongoDB aggregation pipeline.

        –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
        ----------
        - –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ `keywords` –ø—É—Å—Ç ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—á–∞—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤" –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
        - –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞, –ø—Ä–∏–º–µ–Ω—è—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é:
            * –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏ –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏:
                - `None`
                - —Å—Ç—Ä–æ–∫–∏ `"‚Äî"` –∏ `"‚ùì"`
                - –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ `.strip()`
        - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–ª–æ–≤–∞:
            * –ò–∑–≤–ª–µ–∫–∞–µ—Ç `count` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
            * –û—á–∏—â–∞–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç `word`
            * –ü–µ—á–∞—Ç–∞–µ—Ç –≤ –≤–∏–¥–µ: `"‚û°Ô∏è —Å–ª–æ–≤–æ ‚Äî count —Ä–∞–∑"`

        –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
        --------------
        üîç –¢–æ–ø –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:
           ‚û°Ô∏è –∫–æ–º–µ–¥–∏—è ‚Äî 17 —Ä–∞–∑
           ‚û°Ô∏è –•—å—é –î–∂–µ–∫–º–∞–Ω ‚Äî 12 —Ä–∞–∑
           ‚û°Ô∏è –¢–∞—Ä–∞–Ω—Ç–∏–Ω–æ ‚Äî 5 —Ä–∞–∑

        –í—ã–≤–æ–¥:
        ------
        None
            –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –∫–æ–Ω—Å–æ–ª–∏. –í–æ–∑–≤—Ä–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

        –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        -----------
        –ù–µ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π ‚Äî –∑–∞—â–∏—â–µ–Ω–æ –æ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.
        –û—à–∏–±–æ—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–ø–∏—Å–∫–∞.

        –ì–∞—Ä–∞–Ω—Ç–∏–∏:
        ---------
        - –í—Å–µ –≤—ã–≤–æ–¥–∏–º—ã–µ —Å—Ç—Ä–æ–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π.
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ª–æ–≥–∏ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.
        - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è.
        """
    if not keywords:
        print("ü§∑ –ù–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤.")
        return

    print("\nüîç –¢–æ–ø –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:")
    for item in keywords:
        word = item.get("_id")
        if not word or str(word).strip() in ("‚ùì", "‚Äî"):
            continue
        count = item.get("count") or 0
        print(f"   ‚û°Ô∏è {str(word).strip()} ‚Äî {count} —Ä–∞–∑")


def format_top_genres(genres: List[Dict[str, Any]]) -> None:
    """
        –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤,
        –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ —á–∏—Ç–∞–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

        –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
        -----------
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ui_controller.handle_statistics()` –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–∞–Ω—Ä–æ–≤,
        –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –≤—ã–±–∏—Ä–∞–ª–∏—Å—å –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Ñ–∏–ª—å–º–æ–≤. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
        `log_stats.get_top_genres()` ‚Äî –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º –∏–∑ –ª–æ–≥–æ–≤.

        –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
        ----------
        genres : List[Dict[str, Any]]
            –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è:
                - "_id"   : str ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Drama", "Action")
                - "count" : int ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –∂–∞–Ω—Ä—É

            –§–æ—Ä–º–∞—Ç —Ç–∏–ø–∏—á–µ–Ω –¥–ª—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä –∏–∑ MongoDB
            –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ genre ‚Üí count.

        –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
        ----------
        - –ï—Å–ª–∏ `genres` –ø—É—Å—Ç ‚Äî –ø–µ—á–∞—Ç–∞–µ—Ç "–ù–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤" –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
        - –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏—Ö –ø–æ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏:
            * –ü—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –≥–¥–µ:
                - `_id` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (`None`)
                - –ù–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞ ‚Äî `"‚ùì"` –∏–ª–∏ `"‚Äî"` (—Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏)
                - –ü–æ—Å–ª–µ `.strip()` —Å—Ç—Ä–æ–∫–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π
        - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∂–∞–Ω—Ä–∞:
            * –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è `count` ‚Äî —á–∏—Å–ª–æ –æ–±—Ä–∞—â–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
            * –û—á–∏—â–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è
            * –ü–µ—á–∞—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É: `"‚û°Ô∏è –∂–∞–Ω—Ä ‚Äî N —Ä–∞–∑"`

        –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
        --------------
        üé¨ –¢–æ–ø –∂–∞–Ω—Ä–æ–≤:
           ‚û°Ô∏è –ö–æ–º–µ–¥–∏—è ‚Äî 23 —Ä–∞–∑–∞
           ‚û°Ô∏è –ú—É–ª—å—Ç—Ñ–∏–ª—å–º ‚Äî 19 —Ä–∞–∑
           ‚û°Ô∏è –î—Ä–∞–º–∞ ‚Äî 14 —Ä–∞–∑

        –í—ã–≤–æ–¥:
        ------
        None
            –¢–∞–±–ª–∏—Ü–∞ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–æ–Ω—Å–æ–ª—å. –§—É–Ω–∫—Ü–∏—è –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è.

        –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
        -----------
        - –ù–µ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
        - –í—Å–µ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ —Å–ø–∏—Å–∫–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é ‚Äî –æ–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è
          –±–µ–∑ –æ—à–∏–±–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

        –ì–∞—Ä–∞–Ω—Ç–∏–∏:
        ---------
        - –í—ã–≤–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∂–∞–Ω—Ä—ã —Å —á–∏—Å–ª–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–π.
        - –§–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫ –≤—ã—Ä–æ–≤–Ω–µ–Ω –∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
        - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∂–∞–Ω—Ä–æ–≤, –≤–∫–ª—é—á–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü—É –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã.
        """
    if not genres:
        print("ü§∑ –ù–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤.")
        return

    print("\nüé¨ –¢–æ–ø –∂–∞–Ω—Ä–æ–≤:")
    for item in genres:
        genre = item.get("_id")
        if not genre or str(genre).strip() in ("‚ùì", "‚Äî"):
            continue
        count = item.get("count") or 0
        print(f"   ‚û°Ô∏è {str(genre).strip()} ‚Äî {count} —Ä–∞–∑")


def format_last_searches(logs: List[Dict[str, Any]]) -> None:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –≤ –∫–æ–Ω—Å–æ–ª—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ç–∏–ø—É –∑–∞–ø—Ä–æ—Å–∞, –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

    –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
    -----------
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `ui_controller.handle_statistics()` –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
    –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `log_stats.get_last_searches()`, –∏–∑–≤–ª–µ–∫–∞—é—â–∞—è –ª–æ–≥–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
    –∏–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

    –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
    ----------
    logs : List[Dict[str, Any]]
        –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å.
        –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:
            - "timestamp" : datetime ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞
            - "type"      : str      ‚Äî —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞, –æ–¥–∏–Ω –∏–∑:
                * "keyword"
                * "genre_year"
                * "genre_exact_year"
            - "keyword"   : str      ‚Äî –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ (–µ—Å–ª–∏ —Ç–∏–ø "keyword")
            - "genres"    : List[str]‚Äî —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤ (–µ—Å–ª–∏ —Ç–∏–ø —Å–≤—è–∑–∞–Ω —Å –∂–∞–Ω—Ä–∞–º–∏)
            - "years"     : str      ‚Äî –¥–∏–∞–ø–∞–∑–æ–Ω –ª–µ—Ç (–µ—Å–ª–∏ —Ç–∏–ø "genre_year")
            - "year"      : int      ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–æ–¥ (–µ—Å–ª–∏ —Ç–∏–ø "genre_exact_year")

    –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
    ----------
    - –ï—Å–ª–∏ `logs` –ø—É—Å—Ç ‚Äî –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞".
    - –ò–Ω–∞—á–µ ‚Äî –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –ª–æ–≥, –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –µ–≥–æ `timestamp`.
        * –í—Ä–µ–º—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD HH:MM`.
        * –ï—Å–ª–∏ –¥–∞—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `‚Äî` –∫–∞–∫ placeholder.

    - –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `type` –ª–æ–≥ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
        * "keyword" ‚Üí –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å—Ç—Ä–æ–∫–∞: `"üîé –ü–æ –∫–ª—é—á—É: <keyword> (<timestamp>)"`
        * "genre_year" ‚Üí –∂–∞–Ω—Ä—ã + –¥–∏–∞–ø–∞–∑–æ–Ω: `"üé≠ –ü–æ –∂–∞–Ω—Ä–∞–º: <g1, g2> | –ì–æ–¥—ã: <YYYY‚ÄìYYYY> (<timestamp>)"`
        * "genre_exact_year" ‚Üí –∂–∞–Ω—Ä—ã + —Ç–æ—á–Ω—ã–π –≥–æ–¥: `"üéØ –ü–æ –∂–∞–Ω—Ä–∞–º: <g1, g2> | –ì–æ–¥: <YYYY> (<timestamp>)"`
        * –ò–Ω—ã–µ —Ç–∏–ø—ã ‚Üí `"‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ (<timestamp>)"`

    - –î–ª—è –∂–∞–Ω—Ä–æ–≤ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è ‚Äî –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–µ –∏–ª–∏ —à—É–º–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã,
      —Å–ø–∏—Å–æ–∫ –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç –ø—Ä–æ–±–µ–ª–æ–≤ –∏ `None`.

    –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
    --------------
    üïì –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–∏—Å–∫–∏:
       üîé –ü–æ –∫–ª—é—á—É: –¢–∞—Ä–∞–Ω—Ç–∏–Ω–æ (2025-08-06 14:03)
       üé≠ –ü–æ –∂–∞–Ω—Ä–∞–º: –ö–æ–º–µ–¥–∏—è, –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è | –ì–æ–¥—ã: 1995‚Äì2010 (2025-08-06 14:04)
       üéØ –ü–æ –∂–∞–Ω—Ä–∞–º: –î—Ä–∞–º–∞, –ú–µ–ª–æ–¥—Ä–∞–º–∞ | –ì–æ–¥: 2002 (2025-08-06 14:10)

    –í—ã–≤–æ–¥:
    ------
    None
        –§—É–Ω–∫—Ü–∏—è –Ω–∞–ø—Ä—è–º—É—é –ø–µ—á–∞—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª—å. –í–æ–∑–≤—Ä–∞—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç.

    –ò—Å–∫–ª—é—á–µ–Ω–∏—è:
    -----------
    - –ù–µ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
    - –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–ª—é—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π `timestamp` –∏–ª–∏ `genres`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
      –±–µ–∑–æ–ø–∞—Å–Ω–æ —á–µ—Ä–µ–∑ `.get()`, –∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ ("‚Äî").

    –ì–∞—Ä–∞–Ω—Ç–∏–∏:
    ---------
    - –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã, —á–∏—Ç–∞–µ–º—ã –∏ —Å–Ω–∞–±–∂–µ–Ω—ã –º–µ—Ç–∫–∞–º–∏ –ø–æ —Ç–∏–ø—É –∑–∞–ø—Ä–æ—Å–∞.
    - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–ø–æ–ª–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–∏–ø—ã.
    - –í—Å—è –∏—Å—Ç–æ—Ä–∏—è —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–æ–¥–∞–Ω–∞ (—Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º –∫–æ–¥–æ–º).
    """
    if not logs:
        print("üì≠ –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞.")
        return

    print("\nüïì –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–∏—Å–∫–∏:")
    for log in logs:
        ts = log.get("timestamp")
        ts_fmt = ts.strftime("%Y-%m-%d %H:%M") if ts else "‚Äî"

        if log.get("type") == "keyword":
            keyword = str(log.get("keyword") or "‚Äî").strip()
            print(f"   üîé –ü–æ –∫–ª—é—á—É: {keyword} ({ts_fmt})")

        elif log.get("type") == "genre_year":
            genres = ", ".join([g for g in log.get("genres", []) if g and g.strip()])
            year_range = str(log.get("years")).strip() if "years" in log else "‚Äî"
            print(f"   üé≠ –ü–æ –∂–∞–Ω—Ä–∞–º: {genres} | –ì–æ–¥—ã: {year_range} ({ts_fmt})")

        elif log.get("type") == "genre_exact_year":
            genres = ", ".join([g for g in log.get("genres", []) if g and g.strip()])
            year = log.get("year")
            year_display = str(year) if isinstance(year, int) and year > 0 else "‚Äî"
            print(f"   üéØ –ü–æ –∂–∞–Ω—Ä–∞–º: {genres} | –ì–æ–¥: {year_display} ({ts_fmt})")

        else:
            print(f"   ‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ ({ts_fmt})")
